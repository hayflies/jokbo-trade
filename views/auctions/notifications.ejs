<%- include('../partials/header', { title: '알림' }) %>
<section class="card">
  <header class="card-header">
    <h2>완료된 입찰 알림</h2>
  </header>
  <% if (!notifications.length) { %>
  <p class="muted">아직 확인할 알림이 없습니다.</p>
  <% } else { %>
  <ul class="notification-list">
    <% notifications.forEach(function (item) { %>
    <li class="notification-item <%= item.isSeller ? 'is-seller' : 'is-bidder' %>">
      <div class="notification-title">
        <strong><a href="/auctions/<%= item.auction.id %>"><%= item.auction.title %></a></strong>
        <% if (item.isSeller) { %>
        <span class="badge">판매자</span>
        <% } else if (item.isWinner) { %>
        <span class="badge badge-success">낙찰자</span>
        <% } %>
        <% if (item.type === 'REVIEW') { %>
        <span class="badge badge-info">후기</span>
        <% } %>
      </div>
      <p class="notification-message">
        <% if (item.type === 'REVIEW' && item.review) { %>
        <strong><%= item.review.bidderNickname %></strong>님이
        <span class="rating"><%= Number(item.review.score).toFixed(1) %>★</span>
        평가와 후기를 남겼습니다.
        <% if (item.review.comment) { %>
        <q class="notification-comment"><%= item.review.comment %></q>
        <% } %>
        <% } else { %>
        <%= item.message %>
        <% } %>
      </p>
      <p class="notification-meta">
        <% const referenceTime = item.type === 'REVIEW' && item.review && item.review.createdAt ? new Date(item.review.createdAt) : new Date(item.auction.closedAt || item.auction.endTime); %>
        <%= item.type === 'REVIEW' ? '등록 시각' : '종료 시각' %>:
        <time datetime="<%= referenceTime.toISOString() %>">
          <%= referenceTime.toLocaleString('ko-KR') %>
        </time>
      </p>
    </li>
    <% }); %>
  </ul>
  <% } %>
</section>
<%- include('../partials/footer') %>
